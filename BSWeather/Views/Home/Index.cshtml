@using BSWeather.Extensions
@using BSWeather.Models
@using BSWeather.Util
@{
    ViewBag.Title = "Home Page";
    WeatherInstance = ViewBag.Weather;
}
@functions
{
    public OpenWeatherBase.RootObject WeatherInstance;
}
@helper WeatherButton(int? id, string name)
{
    @WeatherButton(id, name, null);
}
@helper WeatherButton(int? id, string name, string glyph)
{
string activeParameter = WeatherInstance.City.Id == id ? "active" : string.Empty;
string spanGlyph = glyph != null ? "<span class=\"glyphicon " + glyph + "\" style=\"padding-left: 4px;\"></span>" : string.Empty;
    <a href="@Url.Action("Index", "Home", new { Id = id })" type="button" class="btn btn-default @activeParameter">
        @name@Html.Raw(spanGlyph)
    </a>
}
@helper WeatherEntry(string leftImageUrl, string leftEntry, string rightEntry)
{
    <div class="row">
        <div class="row-height">
            <div class="col-xs-1 col-height col-middle">
                <div class="inside">
                    <div class="content">
                        <img src="@Url.Content(leftImageUrl)" class="list-icon" />@leftEntry
                    </div>
                </div>
            </div>
            <div class="col-xs-1 col-height col-middle">
                <div class="inside">
                    <div class="content">
                        @rightEntry
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<div class="jumbotron">
    <h1>BSWeather</h1>
    <p class="lead">
        <div class="text-center">
            <div class="btn-group btn-group-lg" role="group">
                @WeatherButton(703448, "Киев")
                @WeatherButton(702550, "Львов")
                @WeatherButton(706483, "Харьков")
                @WeatherButton(709930, "Депропетровск")
                @WeatherButton(698740, "Одесса")
            </div>
        </div>
    </p>
    <p>
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3">
                    @model CitySearch
                    @using (Html.BeginForm("SearchCityByName", "Home", FormMethod.Post, new { Class = "form-horizontal" }))
                    {
                        <div class="form-group">
                            <div class="col-sm-6">
                                @Html.TextBoxFor(model => model.CityName, new { Class = "form-control input-lg", placeholder = "Имя" })
                                @Html.ValidationMessageFor(model => model.CityName)
                            </div>
                            <div class="col-sm-6">
                                <input type="submit" class="btn btn-default btn-lg btn-block" value="Искать">
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </p>
    <p>
        <ul class="list-group">
            <li class="list-group-item row">
                <div class="row">
                    <div class="row-height">
                        <div class="col-xs-1 col-height col-middle">
                            <div class="inside">
                                <div class="content">
                                    <img src="@Url.Content("~/Content/Images/globe-green.png")" class="list-icon"/>Город:
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-1 col-height col-middle">
                            <div class="inside">
                                <div class="content">
                                    <img src="http://openweathermap.org/img/w/@(WeatherInstance.List[0].Weather[0].Icon).png" class="list-icon"/>@(WeatherInstance.City.Name)
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </li>

            <li class="list-group-item row">
                @WeatherEntry("~/Content/Images/calendar-month.png", "Дата:", WeatherInstance.List[0].GetDateTime().ToString("dd/MM/yyyy"))
            </li>
            <li class="list-group-item row">
                @WeatherEntry("~/Content/Images/thermometer.png", "Температура:", (WeatherInstance.List[0].Temp.Day) + "°C")
            </li>
            <li class="list-group-item row">
                @WeatherEntry("~/Content/Images/counter.png", "Давление:", (WeatherInstance.List[0].Pressure) + " мбар")
            </li>
            <li class="list-group-item row">
                @WeatherEntry("~/Content/Images/water.png", "Влажность:", (WeatherInstance.List[0].Humidity) + "%")
            </li>
            <li class="list-group-item row">
                @WeatherEntry("~/Content/Images/weather-wind.png", "Скорость ветра:", (WeatherInstance.List[0].Speed) + " м/с")
            </li>
        </ul>
    </p>

    <div class="row">
        <div class="col-md-4">
            <h2>Погода на сегодня</h2>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301865">Просмотреть &raquo;</a></p>
        </div>
        <div class="col-md-4">
            <h2>Погода на три дня</h2>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301866">Просмотреть &raquo;</a></p>
        </div>
        <div class="col-md-4">
            <h2>Погода на неделю</h2>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301867">Просмотреть &raquo;</a></p>
        </div>
    </div>
</div>